package tests;

import org.testng.annotations.Test;

import base.BaseTest;
import pages.AddressPage;
import pages.BookDetailPage;
import pages.HomePage;
import pages.LoginPage;
import pages.ReviewOrderPage;
import pages.SearchResultsPage;

public class LoginTest extends BaseTest {

    @Test
    public void loginSearchFirstBookBuyNowAddress() {
        startTest("Full Flow: Login → Search → Buy → Address Selection");

        // 1. Home → My Account → Login
        HomePage home = new HomePage(driver);
        home.openSite();
        test.info("Opened Bookswagon homepage");

        home.goToLoginFromMyAccount();
        test.info("Navigated to login page");

        // 2. Login with your credentials
        LoginPage login = new LoginPage(driver);
        login.loginWithYourAccount();
        test.info("Submitted login credentials");

        // 3. Wait for login to complete, then reload homepage
        try {
            Thread.sleep(3000);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        home.openSite();  // reloads homepage (search elements available)
        test.info("Returned to homepage after login");

        // 4. Search a book
        home.searchBook("Selenium");
        test.info("Searched for Selenium books");

        // 5. Click first book (your Selenium book)
        SearchResultsPage results = new SearchResultsPage(driver);
        results.clickFirstBook();
        test.info("Clicked first book title (Selenium book)");

        // 6. On book detail page, click Buy Now
        BookDetailPage bookDetail = new BookDetailPage(driver);
        bookDetail.clickBuyNow();
        test.info("Clicked Buy Now button on book detail page");

        // 7. Select saved address
        AddressPage address = new AddressPage(driver);
        address.selectSavedAddress();
        test.info("Selected saved address - Deliver to this Address");
        
        // 8. Review Order Page
        ReviewOrderPage reviewOrder = new ReviewOrderPage(driver);
        reviewOrder.clickSaveAndContinue();
        test.info("Clicked Save & Continue");

        test.pass("Full flow completed: reached checkout after address selection");
    }
}
